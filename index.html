<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Duck√©mon: Alpha Evolution</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root { 
            --grass: #1b4d3e; --water: #0f2d4d; --sand: #b5a642; --void: #1a1a1a;
            --p-yellow: #f1c40f; --alpha-gold: #ff4500;
        }
        
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #000; font-family: 'Press Start 2P', cursive; color: #fff; overflow: hidden; image-rendering: pixelated; }

        /* --- THE INFINITE CANVAS --- */
        #viewport { position: relative; width: 100vw; height: 100vh; overflow: hidden; }
        #world { position: absolute; transition: transform 0.1s cubic-bezier(0.1, 0.5, 0.1, 1); }
        
        .tile { width: 50px; height: 50px; position: absolute; border: 1px solid rgba(255,255,255,0.02); }
        .t-0 { background: var(--grass); }
        .t-1 { background: var(--water); }
        .t-2 { background: var(--sand); }
        .t-3 { background: #222; box-shadow: inset 0 0 15px #ff4500; }

        /* --- PIXEL ART EVOLUTION --- */
        .pixel-duck {
            width: 4px; height: 4px; background: transparent;
            box-shadow: 
                8px 4px 0 var(--c), 12px 4px 0 var(--c),
                8px 8px 0 var(--c), 12px 8px 0 var(--c), 16px 8px 0 #e67e22,
                4px 12px 0 var(--c), 8px 12px 0 var(--c), 12px 12px 0 var(--c),
                12px 4px 0 #000;
            position: absolute; transform: scale(2.5); transition: 0.3s;
        }

        /* Evolution Effect: Extra Pixels/Spikes */
        .alpha-form {
            box-shadow: 
                8px 4px 0 var(--c), 12px 4px 0 var(--c),
                8px 0px 0 #fff, 12px 0px 0 #fff, /* Crown Pixels */
                8px 8px 0 var(--c), 12px 8px 0 var(--c), 16px 8px 0 #e67e22,
                0px 12px 0 #ff4500, 4px 12px 0 var(--c), 8px 12px 0 var(--c), 12px 12px 0 var(--c), 16px 12px 0 #ff4500, /* Wing Spikes */
                12px 4px 0 #000 !important;
            transform: scale(3.5) !important;
        }

        #player-container { position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); z-index: 100; }

        /* --- MINIMAP --- */
        #minimap {
            position: absolute; top: 20px; right: 20px; width: 120px; height: 120px;
            background: rgba(0,0,0,0.8); border: 3px solid #fff; z-index: 1000;
        }
        #mini-dot { position: absolute; width: 4px; height: 4px; background: red; top: 58px; left: 58px; }

        /* --- HUD & BATTLE --- */
        #hud { position: absolute; bottom: 0; width: 100%; background: #111; padding: 20px; display: flex; justify-content: space-between; font-size: 10px; border-top: 3px solid var(--alpha-gold); }
        .screen { display: none; position: absolute; inset: 0; z-index: 2000; background: #000; flex-direction: column; align-items: center; justify-content: center; }
        .btn { font-family: 'Press Start 2P'; padding: 12px; border: 3px solid #fff; background: #000; color: #fff; cursor: pointer; font-size: 10px; margin: 5px; }
    </style>
</head>
<body onload="init()">

<div id="viewport">
    <div id="minimap"><div id="mini-dot"></div></div>
    <div id="world"></div>
    <div id="player-container">
        <div id="p-sprite" class="pixel-duck" style="--c:var(--p-yellow)"></div>
    </div>

    <div id="battle-screen" class="screen">
        <h2 id="b-header">CONFRONTATION</h2>
        <div style="display:flex; justify-content:space-around; width:100%; margin: 40px;">
            <div id="p-b-sprite" class="pixel-duck" style="--c:var(--p-yellow); position:relative;"></div>
            <div id="e-b-sprite" class="pixel-duck" style="position:relative; transform:scale(8) scaleX(-1)"></div>
        </div>
        <div id="moves">
            <button class="btn" onclick="attack()">ALPHA STRIKE</button>
            <button class="btn" onclick="run()">FLEE</button>
        </div>
    </div>

    <div id="hud">
        <div>LVL: <span id="lvl">1</span> <span id="evolve-msg" style="color:var(--alpha-gold)"></span></div>
        <div>SPEED: <span id="speed-stat">NORMAL</span></div>
        <div>COORD: <span id="coords">0,0</span></div>
    </div>
</div>

<script>
    let pos = { x: 0, y: 0 };
    let player = { lvl: 1, hp: 100, isAlpha: false, speed: 50 };
    let rendered = {};
    const tileSize = 50;

    function init() {
        renderMap();
        window.addEventListener('keydown', (e) => {
            if(document.getElementById('battle-screen').style.display === 'flex') return;
            const k = e.key.toLowerCase();
            const s = player.speed;
            if(k === 'w') pos.y += s;
            if(k === 's') pos.y -= s;
            if(k === 'a') pos.x -= s;
            if(k === 'd') pos.x += s;
            
            // Shift Speed Toggle
            if(e.shiftKey) { player.speed = 100; document.getElementById('speed-stat').innerText = "BOOST"; }
            else { player.speed = 50; document.getElementById('speed-stat').innerText = "NORMAL"; }

            renderMap();
            if(Math.random() < 0.05) startBattle();
        });
    }

    function renderMap() {
        const world = document.getElementById('world');
        const r = 10;
        for (let i = -r; i < r; i++) {
            for (let j = -r; j < r; j++) {
                let tx = Math.floor(pos.x / tileSize) + i;
                let ty = Math.floor(pos.y / tileSize) + j;
                let key = `${tx},${ty}`;
                if (!rendered[key]) {
                    const t = document.createElement('div');
                    let zone = (Math.abs(tx) > 30) ? 3 : (ty < -15) ? 1 : (tx > 15) ? 2 : 0;
                    t.className = `tile t-${zone}`;
                    t.style.left = tx * tileSize + 'px';
                    t.style.top = -ty * tileSize + 'px';
                    world.appendChild(t);
                    rendered[key] = true;
                }
            }
        }
        world.style.transform = `translate(${-pos.x + (window.innerWidth/2)}px, ${pos.y + (window.innerHeight/2)}px)`;
        document.getElementById('coords').innerText = `${Math.floor(pos.x/tileSize)},${Math.floor(pos.y/tileSize)}`;
    }

    function startBattle() {
        document.getElementById('battle-screen').style.display = 'flex';
        const eColor = '#'+(Math.random()*0xFFFFFF<<0).toString(16);
        document.getElementById('e-b-sprite').style.setProperty('--c', eColor);
        
        // Match player battle sprite to evolution
        const pbs = document.getElementById('p-b-sprite');
        pbs.className = player.isAlpha ? "pixel-duck alpha-form" : "pixel-duck";
        pbs.style.transform = player.isAlpha ? "scale(6)" : "scale(8)";
    }

    function attack() {
        player.lvl++;
        checkEvolution();
        document.getElementById('battle-screen').style.display = 'none';
        document.getElementById('lvl').innerText = player.lvl;
    }

    function checkEvolution() {
        if(player.lvl >= 10 && !player.isAlpha) {
            player.isAlpha = true;
            document.getElementById('p-sprite').classList.add('alpha-form');
            document.getElementById('evolve-msg').innerText = "[ALPHA FORM]";
            alert("WHAT?! Your Duck is evolving into ALPHA FORM!");
        }
    }

    function run() { document.getElementById('battle-screen').style.display = 'none'; }
</script>
</body>
</html>
