<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DuckÃ©mon: Strategy Master</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root { 
            --hydro: #4cc9f0; --pyro: #e63946; --leaf: #91d18b; --void: #9d4edd; 
            --bolt: #ffea00; --rock: #a38671; --ice: #a2d2ff; --ghost: #6c757d;
            --bg: #2d3436; --panel: #dfe6e9;
        }
        body { margin: 0; background: var(--bg); font-family: 'Press Start 2P', cursive; color: #2d3436; display: flex; flex-direction: column; align-items: center; overflow: hidden; }

        /* --- STYLIZED SPRITE --- */
        .duck {
            position: relative; width: 45px; height: 40px;
            background: var(--c, #ffcc00); border-radius: 22px 22px 12px 12px;
            box-shadow: inset -5px -5px 0 rgba(0,0,0,0.15), 0 4px 0 rgba(0,0,0,0.2);
            transition: 0.3s;
        }
        .duck::before { content: ''; position: absolute; width: 14px; height: 10px; background: #fb8500; right: -7px; top: 14px; border-radius: 0 12px 12px 0; border: 2px solid #000; }
        .duck::after { content: ''; position: absolute; width: 6px; height: 6px; background: #000; right: 10px; top: 10px; border-radius: 50%; }
        .wing { position: absolute; width: 22px; height: 12px; background: rgba(0,0,0,0.1); left: 6px; top: 18px; border-radius: 12px; border: 1px solid rgba(0,0,0,0.1); }

        /* --- VISUALS & LAYOUT --- */
        #viewport { width: 360px; height: 320px; border: 10px solid #636e72; position: relative; overflow: hidden; background: #55efc4; margin-top: 15px; box-shadow: 0 10px 0 #2d3436; }
        #battle-screen { display: none; position: absolute; inset: 0; background: white; z-index: 100; flex-direction: column; align-items: center; justify-content: space-around; padding: 20px; }
        #party-menu { display: none; position: absolute; inset: 10px; background: var(--panel); border: 6px solid #2d3436; z-index: 50; padding: 15px; box-sizing: border-box; }

        /* --- STAT CARDS --- */
        .stat-box { background: #2d3436; color: white; padding: 10px; border-radius: 4px; border-left: 8px solid var(--c); margin-bottom: 10px; font-size: 8px; }
        .hp-container { width: 100%; height: 14px; background: #636e72; border: 3px solid #000; position: relative; }
        .hp-fill { height: 100%; background: #55efc4; width: 100%; transition: 0.5s cubic-bezier(0.18, 0.89, 0.32, 1.28); }
        .type-badge { padding: 4px 8px; border-radius: 4px; color: white; font-size: 7px; text-shadow: 1px 1px #000; }

        /* --- UI --- */
        #hud { width: 380px; background: #636e72; padding: 15px; box-sizing: border-box; border-radius: 0 0 20px 20px; }
        .controls { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; margin-top: 10px; }
        .btn { background: #dfe6e9; border: none; border-bottom: 4px solid #b2bec3; padding: 12px; font-family: inherit; font-size: 8px; cursor: pointer; transition: 0.1s; }
        .btn:active { transform: translateY(2px); border-bottom-width: 2px; }
        .btn-red { background: #ff7675; color: white; border-bottom-color: #d63031; }
    </style>
</head>
<body onload="init()">

    <div id="viewport">
        <div id="player" style="position: absolute; transition: 0.1s linear; z-index: 10;">
            <div id="p-sprite" class="duck"><div class="wing"></div></div>
        </div>

        <div id="battle-screen">
            <div style="width: 100%;">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <span id="e-name" style="font-size:10px">WILD</span>
                    <span id="e-type-badge" class="type-badge">TYPE</span>
                </div>
                <div class="hp-container"><div id="e-hp-fill" class="hp-fill"></div></div>
                <div style="font-size:7px; text-align:right">LV:<span id="e-lvl">1</span></div>
            </div>

            <div id="e-sprite-cont"></div>

            <div style="width: 100%;">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <span id="p-active-name" style="font-size:10px">YOU</span>
                    <span id="p-type-badge" class="type-badge">TYPE</span>
                </div>
                <div class="hp-container"><div id="p-hp-fill" class="hp-fill"></div></div>
            </div>

            <div style="display:flex; gap:10px; width:100%">
                <button class="btn btn-red" style="flex:2" onclick="fight()">QUACK ATTACK</button>
                <button class="btn" style="flex:1" onclick="catchDuck()">CATCH</button>
            </div>
        </div>

        <div id="party-menu">
            <h2 style="text-align:center; font-size:12px;">DUCK-DEX</h2>
            <div id="party-list"></div>
            <button class="btn" style="width:100%; margin-top:10px;" onclick="toggleParty()">BACK TO WORLD</button>
        </div>
    </div>

    <div id="hud">
        <div style="display:flex; justify-content:space-between; color:white; font-size:8px;">
            <span>TEAM: <span id="team-count">1</span>/3</span>
            <span>ðŸ¥– BREAD: <span id="bread">0</span></span>
        </div>
        <div class="controls">
            <button class="btn" onclick="toggleParty()">STATS</button>
            <button class="btn" onclick="move(0, -30)">UP</button>
            <button class="btn btn-red" onclick="heal()">HEAL (20)</button>
            <button class="btn" onclick="move(-30, 0)">LEFT</button>
            <button class="btn" onclick="move(0, 30)">DOWN</button>
            <button class="btn" onclick="move(30, 0)">RIGHT</button>
        </div>
    </div>

    <script>
        let pPos = { x: 150, y: 150 };
        let bread = 0;
        let party = [{ name: "QUACKER", lvl: 5, hp: 100, maxHp: 100, type: "HYDRO", color: "#4cc9f0" }];
        let activeIdx = 0;
        let enemy = null;

        const types = {
            HYDRO: { color: "#4cc9f0", weak: "BOLT", strong: "PYRO" },
            PYRO:  { color: "#e63946", weak: "HYDRO", strong: "LEAF" },
            LEAF:  { color: "#91d18b", weak: "PYRO", strong: "ROCK" },
            BOLT:  { color: "#ffea00", weak: "
