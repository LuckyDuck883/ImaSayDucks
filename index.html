<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Duck Quest: Drip Edition</title>
    <style>
        :root { --water: #4cc9f0; --gold: #ffb703; --boss: #e63946; }
        body { font-family: 'Courier New', Courier, monospace; background: #222; color: white; text-align: center; margin: 0; overflow: hidden; }
        
        /* UI and Layout */
        #ui-bar { background: #333; padding: 10px; display: flex; justify-content: space-around; border-bottom: 4px solid var(--water); }
        #game-world { position: relative; width: 90vw; height: 45vh; background: var(--water); margin: 15px auto; border-radius: 20px; border: 8px solid #0077b6; overflow: hidden; }
        
        /* Customizer Modal */
        #customizer { background: #444; padding: 15px; border-radius: 10px; display: inline-block; margin-top: 10px; border: 2px solid var(--gold); }
        .swatch { display: inline-block; width: 30px; height: 30px; margin: 5px; cursor: pointer; border-radius: 50%; border: 2px solid white; }
        
        /* Duck Styling */
        .duck-container { position: absolute; cursor: pointer; user-select: none; text-align: center; }
        .duck-body { font-size: 50px; transition: filter 0.3s; }
        .duck-hat { font-size: 25px; position: absolute; top: -15px; left: 12px; }
        
        .boss { font-size: 150px; position: absolute; left: 35%; top: 10%; }
        #boss-hp-container { display: none; width: 80%; background: #555; height: 15px; margin: 5px auto; border-radius: 10px; }
        #boss-hp-fill { background: var(--boss); width: 100%; height: 100%; border-radius: 10px; }

        .btn { background: var(--gold); border: none; padding: 8px 12px; border-radius: 8px; cursor: pointer; font-weight: bold; margin: 5px; }
        #save-note { color: #b5e48c; font-size: 0.8rem; opacity: 0; }
    </style>
</head>
<body>

    <div id="ui-bar">
        <div>‚≠ê Lvl: <span id="lvl">1</span></div>
        <div>üçû Bread: <span id="bread">0</span></div>
        <div>üìà XP: <span id="xp">0</span>/<span id="next-lvl">10</span></div>
    </div>

    <div id="boss-hp-container"><div id="boss-hp-fill"></div></div>
    <div id="game-world"></div>

    <div id="customizer">
        <strong>üé® Customize Your Catch:</strong><br>
        <div class="swatch" style="background: yellow" onclick="changeColor('none')"></div>
        <div class="swatch" style="background: #ff758f" onclick="changeColor('hue-rotate(300deg)')"></div>
        <div class="swatch" style="background: #70e000" onclick="changeColor('hue-rotate(90deg)')"></div>
        <div class="swatch" style="background: #7209b7" onclick="changeColor('hue-rotate(240deg)')"></div>
        <br>
        <button class="btn" onclick="changeHat('ü§†')">Cowboy Hat (20ü•ñ)</button>
        <button class="btn" onclick="changeHat('üëë')">Crown (100ü•ñ)</button>
        <button class="btn" onclick="changeHat('')">No Hat</button>
    </div>

    <div id="shop">
        <button class="btn" onclick="buyUpgrade('click')">Net (+1 Pwr) - <span id="cost-click">15</span>ü•ñ</button>
        <button class="btn" onclick="buyUpgrade('auto')">Trap (+1 Spd) - <span id="cost-auto">60</span>ü•ñ</button>
    </div>
    <div id="save-note">Progress Saved!</div>

    <script>
        let stats = {
            bread: 0, xp: 0, lvl: 1, xpToNext: 10, 
            clickPower: 1, autoLevel: 0,
            duckColor: 'none', duckHat: ''
        };

        function init() {
            const saved = localStorage.getItem('duckQuestRPG');
            if (saved) {
                stats = JSON.parse(saved);
                for(let i=0; i < stats.autoLevel; i++) {
                    setInterval(() => { gainXP(1); }, 2000);
                }
            }
            updateUI();
        }

        function save() {
            localStorage.setItem('duckQuestRPG', JSON.stringify(stats));
            const note = document.getElementById('save-note');
            note.style.opacity = 1;
            setTimeout(() => note.style.opacity = 0, 1000);
        }

        function updateUI() {
            document.getElementById('bread').innerText = stats.bread;
            document.getElementById('xp').innerText = stats.xp;
            document.getElementById('lvl').innerText = stats.lvl;
            document.getElementById('next-lvl').innerText = stats.xpToNext;
            document.getElementById('cost-click').innerText = 15 + (stats.clickPower * 5);
            document.getElementById('cost-auto').innerText = 60 + (stats.autoLevel * 20);
        }

        function changeColor(filter) {
            stats.duckColor = filter;
            save();
        }

        function changeHat(hat) {
            let cost = hat === 'ü§†' ? 20 : (hat === 'üëë' ? 100 : 0);
            if (stats.bread >= cost) {
                stats.bread -= cost;
                stats.duckHat = hat;
                updateUI();
                save();
            } else {
                alert("Not enough bread for that drip!");
            }
        }

        function createDuck() {
            const world = document.getElementById('game-world');
            const container = document.createElement('div');
            container.className = 'duck-container';
            
            // Apply Customizations
            container.innerHTML = `
                <div class="duck-hat">${stats.duckHat}</div>
                <div class="duck-body" style="filter: ${stats.duckColor}">ü¶Ü</div>
            `;
            
            container.style.left = Math.random() * 80 + '%';
            container.style.top = Math.random() * 70 + '%';

            container.onclick = () => {
                gainXP(stats.clickPower);
                stats.bread += Math.floor(Math.random() * 3) + 1;
                container.remove();
                updateUI();
                save();
            };
            world.appendChild(container);
            setTimeout(() => container.remove(), 2500);
        }

        function gainXP(amount) {
            stats.xp += amount;
            if (stats.xp >= stats.xpToNext) {
                stats.lvl++;
                stats.xp = 0;
                stats.xpToNext = Math.floor(stats.xpToNext * 1.6);
            }
            updateUI();
        }

        init();
        setInterval(createDuck, 1200);
    </script>
</body>
</html>
