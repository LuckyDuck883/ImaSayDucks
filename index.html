<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Duck√©mon: Open World Explorer</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root { --grass: #70e000; --water: #48cae4; --dark: #1a1a1a; --player: #ffcc00; }
        body { margin: 0; background: #000; font-family: 'Press Start 2P', cursive; overflow: hidden; color: white; display: flex; flex-direction: column; align-items: center; }

        /* --- THE OVERWORLD --- */
        #world-container {
            width: 350px; height: 350px;
            background: var(--grass);
            position: relative; overflow: hidden;
            border: 8px solid #444; margin-top: 20px;
        }

        /* Decorative "Grass" patches that trigger battles */
        .tall-grass { position: absolute; width: 50px; height: 50px; background: #55a600; opacity: 0.5; border-radius: 10px; }

        /* --- THE PLAYER --- */
        #player {
            width: 32px; height: 32px; background: var(--player);
            position: absolute; transition: all 0.1s linear;
            clip-path: polygon(25% 0%, 75% 0%, 100% 25%, 100% 100%, 0% 100%, 0% 25%);
            z-index: 10; border-radius: 5px;
        }

        /* --- BATTLE SCREEN --- */
        #battle-screen {
            display: none; position: absolute; top: 0; left: 0;
            width: 100%; height: 100%; background: #fff; color: #000;
            z-index: 100; flex-direction: column; align-items: center; justify-content: space-around;
        }

        .battle-duck { width: 80px; height: 80px; transform: scaleX(-1); }
        .hp-bar { width: 150px; height: 10px; background: #ccc; border: 2px solid #000; margin-top: 5px; }
        #enemy-hp-fill { height: 100%; background: #f00; width: 100%; transition: 0.3s; }

        /* --- CONTROLS --- */
        #ui { width: 350px; padding: 15px; background: #222; border: 4px solid #444; box-sizing: border-box; }
        .d-pad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; width: 150px; margin: 10px auto; }
        .btn { background: #eee; border: 4px solid #aaa; padding: 10px; font-family: inherit; font-size: 8px; cursor: pointer; }
        .btn:active { background: #ccc; }

        #stats { font-size: 8px; text-align: left; line-height: 1.6; }
    </style>
</head>
<body onload="init()">

    <div id="world-container">
        <div class="tall-grass" style="top:50px; left:50px;"></div>
        <div class="tall-grass" style="top:200px; left:250px;"></div>
        <div class="tall-grass" style="top:100px; left:180px;"></div>
        
        <div id="player"></div>

        <div id="battle-screen">
            <div id="battle-msg">WILD DUCK APPEARED!</div>
            <div id="enemy-sprite" style="background:red; width:60px; height:60px; clip-path: polygon(25% 0%, 75% 0%, 100% 25%, 100% 100%, 0% 100%, 0% 25%);"></div>
            <div>
                ENEMY HP
                <div class="hp-bar"><div id="enemy-hp-fill"></div></div>
            </div>
            <button class="btn" onclick="attack()">QUACK ATTACK!</button>
        </div>
    </div>

    <div id="ui">
        <div id="stats">
            NAME: PLAYER<br>
            LVL: <span id="lvl">1</span> | XP: <span id="xp">0</span>/50
        </div>
        
        <div class="d-pad">
            <div></div><button class="btn" onclick="move(0, -30)">UP</button><div></div>
            <button class="btn" onclick="move(-30, 0)">LFT</button><div></div><button class="btn" onclick="move(30, 0)">RGT</button>
            <div></div><button class="btn" onclick="move(0, 30)">DWN</button><div></div>
        </div>
    </div>

    <script>
        let pPos = { x: 150, y: 150 };
        let stats = { lvl: 1, xp: 0, next: 50 };
        let enemyHP = 100;

        function init() {
            updatePlayer();
        }

        function move(dx, dy) {
            if (document.getElementById('battle-screen').style.display === 'flex') return;

            pPos.x = Math.max(0, Math.min(310, pPos.x + dx));
            pPos.y = Math.max(0, Math.min(310, pPos.y + dy));
            updatePlayer();

            // Random Battle Encounter Chance
            if (Math.random() < 0.2) {
                startBattle();
            }
        }

        function updatePlayer() {
            const p = document.getElementById('player');
            p.style.left = pPos.x + 'px';
            p.style.top = pPos.y + 'px';

            // Visual evolution
            if (stats.lvl >= 10) p.style.background = '#4cc9f0';
            if (stats.lvl >= 25) p.style.background = '#ff4d4d';
            if (stats.lvl >= 50) p.style.filter = 'drop-shadow(0 0 10px gold)';
        }

        function startBattle() {
            const screen = document.getElementById('battle-screen');
            screen.style.display = 'flex';
            enemyHP = 100;
            updateHP();
            document.getElementById('battle-msg').innerText = "WILD DUCK APPEARED!";
        }

        function attack() {
            enemyHP -= 34; // 3 hits to kill
            updateHP();
            
            if (enemyHP <= 0) {
                document.getElementById('battle-msg').innerText = "VICTORY!";
                setTimeout(() => {
                    gainXP(25);
                    document.getElementById('battle-screen').style.display = 'none';
                }, 1000);
            }
        }

        function gainXP(amt) {
            stats.xp += amt;
            if (stats.xp >= stats.next) {
                stats.lvl++;
                stats.xp = 0;
                stats.next = Math.floor(stats.next * 1.5);
                alert("LEVEL UP! YOU ARE NOW LVL " + stats.lvl);
            }
            updateUI();
        }

        function updateHP() {
            document.getElementById('enemy-hp-fill').style.width = enemyHP + '%';
        }

        function updateUI() {
            document.getElementById('lvl').innerText = stats.lvl;
            document.getElementById('xp').innerText = stats.xp;
            updatePlayer();
        }
    </script>
</body>
</html>
